/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function t(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}const e=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),i=new Map;class r{constructor(t,e){if(this._$cssResult$=!0,e!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){let t=i.get(this.cssText);return e&&void 0===t&&(i.set(this.cssText,t=new CSSStyleSheet),t.replaceSync(this.cssText)),t}toString(){return this.cssText}}const o=(t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,n,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+t[i+1]),t[0]);return new r(i,n)},a=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return(t=>new r("string"==typeof t?t:t+"",n))(e)})(t):t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var s;const c=window.trustedTypes,l=c?c.emptyScript:"",u=window.reactiveElementPolyfillSupport,h={toAttribute(t,e){switch(e){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},d=(t,e)=>e!==t&&(e==e||t==t),f={attribute:!0,type:String,converter:h,reflect:!1,hasChanged:d};class p extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(t){var e;null!==(e=this.l)&&void 0!==e||(this.l=[]),this.l.push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,n)=>{const i=this._$Eh(n,e);void 0!==i&&(this._$Eu.set(i,n),t.push(i))})),t}static createProperty(t,e=f){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const n="symbol"==typeof t?Symbol():"__"+t,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const r=this[t];this[e]=i,this.requestUpdate(t,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||f}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),this.elementProperties=new Map(t.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const n of e)this.createProperty(n,t[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Eh(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}o(){var t;this._$Ep=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(t=this.constructor.l)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,n;(null!==(e=this._$Eg)&&void 0!==e?e:this._$Eg=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(n=t.hostConnected)||void 0===n||n.call(t))}removeController(t){var e;null===(e=this._$Eg)||void 0===e||e.splice(this._$Eg.indexOf(t)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Et.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const n=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,n)=>{e?t.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((e=>{const n=document.createElement("style"),i=window.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=e.cssText,t.appendChild(n)}))})(n,this.constructor.elementStyles),n}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$ES(t,e,n=f){var i,r;const o=this.constructor._$Eh(t,n);if(void 0!==o&&!0===n.reflect){const a=(null!==(r=null===(i=n.converter)||void 0===i?void 0:i.toAttribute)&&void 0!==r?r:h.toAttribute)(e,n.type);this._$Ei=t,null==a?this.removeAttribute(o):this.setAttribute(o,a),this._$Ei=null}}_$AK(t,e){var n,i,r;const o=this.constructor,a=o._$Eu.get(t);if(void 0!==a&&this._$Ei!==a){const t=o.getPropertyOptions(a),s=t.converter,c=null!==(r=null!==(i=null===(n=s)||void 0===n?void 0:n.fromAttribute)&&void 0!==i?i:"function"==typeof s?s:null)&&void 0!==r?r:h.fromAttribute;this._$Ei=a,this[a]=c(e,t.type),this._$Ei=null}}requestUpdate(t,e,n){let i=!0;void 0!==t&&(((n=n||this.constructor.getPropertyOptions(t)).hasChanged||d)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===n.reflect&&this._$Ei!==t&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(t,n))):i=!1),!this.isUpdatePending&&i&&(this._$Ep=this._$EC())}async _$EC(){this.isUpdatePending=!0;try{await this._$Ep}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Et&&(this._$Et.forEach(((t,e)=>this[e]=t)),this._$Et=void 0);let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),null===(t=this._$Eg)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(n)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(n)}willUpdate(t){}_$AE(t){var e;null===(e=this._$Eg)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(t){return!0}update(t){void 0!==this._$E_&&(this._$E_.forEach(((t,e)=>this._$ES(e,this[e],t))),this._$E_=void 0),this._$EU()}updated(t){}firstUpdated(t){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var v;p.finalized=!0,p.elementProperties=new Map,p.elementStyles=[],p.shadowRootOptions={mode:"open"},null==u||u({ReactiveElement:p}),(null!==(s=globalThis.reactiveElementVersions)&&void 0!==s?s:globalThis.reactiveElementVersions=[]).push("1.2.0");const y=globalThis.trustedTypes,g=y?y.createPolicy("lit-html",{createHTML:t=>t}):void 0,m=`lit$${(Math.random()+"").slice(9)}$`,w="?"+m,b=`<${w}>`,x=document,_=(t="")=>x.createComment(t),S=t=>null===t||"object"!=typeof t&&"function"!=typeof t,E=Array.isArray,$=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,A=/-->/g,C=/>/g,k=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,P=/'/g,T=/"/g,N=/^(?:script|style|textarea)$/i,O=(t=>(e,...n)=>({_$litType$:t,strings:e,values:n}))(1),U=Symbol.for("lit-noChange"),R=Symbol.for("lit-nothing"),M=new WeakMap,L=x.createTreeWalker(x,129,null,!1),j=(t,e)=>{const n=t.length-1,i=[];let r,o=2===e?"<svg>":"",a=$;for(let e=0;e<n;e++){const n=t[e];let s,c,l=-1,u=0;for(;u<n.length&&(a.lastIndex=u,c=a.exec(n),null!==c);)u=a.lastIndex,a===$?"!--"===c[1]?a=A:void 0!==c[1]?a=C:void 0!==c[2]?(N.test(c[2])&&(r=RegExp("</"+c[2],"g")),a=k):void 0!==c[3]&&(a=k):a===k?">"===c[0]?(a=null!=r?r:$,l=-1):void 0===c[1]?l=-2:(l=a.lastIndex-c[2].length,s=c[1],a=void 0===c[3]?k:'"'===c[3]?T:P):a===T||a===P?a=k:a===A||a===C?a=$:(a=k,r=void 0);const h=a===k&&t[e+1].startsWith("/>")?" ":"";o+=a===$?n+b:l>=0?(i.push(s),n.slice(0,l)+"$lit$"+n.slice(l)+m+h):n+m+(-2===l?(i.push(void 0),e):h)}const s=o+(t[n]||"<?>")+(2===e?"</svg>":"");if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==g?g.createHTML(s):s,i]};class D{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let r=0,o=0;const a=t.length-1,s=this.parts,[c,l]=j(t,e);if(this.el=D.createElement(c,n),L.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(i=L.nextNode())&&s.length<a;){if(1===i.nodeType){if(i.hasAttributes()){const t=[];for(const e of i.getAttributeNames())if(e.endsWith("$lit$")||e.startsWith(m)){const n=l[o++];if(t.push(e),void 0!==n){const t=i.getAttribute(n.toLowerCase()+"$lit$").split(m),e=/([.?@])?(.*)/.exec(n);s.push({type:1,index:r,name:e[2],strings:t,ctor:"."===e[1]?B:"?"===e[1]?J:"@"===e[1]?q:V})}else s.push({type:6,index:r})}for(const e of t)i.removeAttribute(e)}if(N.test(i.tagName)){const t=i.textContent.split(m),e=t.length-1;if(e>0){i.textContent=y?y.emptyScript:"";for(let n=0;n<e;n++)i.append(t[n],_()),L.nextNode(),s.push({type:2,index:++r});i.append(t[e],_())}}}else if(8===i.nodeType)if(i.data===w)s.push({type:2,index:r});else{let t=-1;for(;-1!==(t=i.data.indexOf(m,t+1));)s.push({type:7,index:r}),t+=m.length-1}r++}}static createElement(t,e){const n=x.createElement("template");return n.innerHTML=t,n}}function z(t,e,n=t,i){var r,o,a,s;if(e===U)return e;let c=void 0!==i?null===(r=n._$Cl)||void 0===r?void 0:r[i]:n._$Cu;const l=S(e)?void 0:e._$litDirective$;return(null==c?void 0:c.constructor)!==l&&(null===(o=null==c?void 0:c._$AO)||void 0===o||o.call(c,!1),void 0===l?c=void 0:(c=new l(t),c._$AT(t,n,i)),void 0!==i?(null!==(a=(s=n)._$Cl)&&void 0!==a?a:s._$Cl=[])[i]=c:n._$Cu=c),void 0!==c&&(e=z(t,c._$AS(t,e.values),c,i)),e}class I{constructor(t,e){this.v=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(t){var e;const{el:{content:n},parts:i}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:x).importNode(n,!0);L.currentNode=r;let o=L.nextNode(),a=0,s=0,c=i[0];for(;void 0!==c;){if(a===c.index){let e;2===c.type?e=new H(o,o.nextSibling,this,t):1===c.type?e=new c.ctor(o,c.name,c.strings,this,t):6===c.type&&(e=new G(o,this,t)),this.v.push(e),c=i[++s]}a!==(null==c?void 0:c.index)&&(o=L.nextNode(),a++)}return r}m(t){let e=0;for(const n of this.v)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class H{constructor(t,e,n,i){var r;this.type=2,this._$AH=R,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cg=null===(r=null==i?void 0:i.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cg}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=z(this,t,e),S(t)?t===R||null==t||""===t?(this._$AH!==R&&this._$AR(),this._$AH=R):t!==this._$AH&&t!==U&&this.$(t):void 0!==t._$litType$?this.T(t):void 0!==t.nodeType?this.S(t):(t=>{var e;return E(t)||"function"==typeof(null===(e=t)||void 0===e?void 0:e[Symbol.iterator])})(t)?this.A(t):this.$(t)}M(t,e=this._$AB){return this._$AA.parentNode.insertBefore(t,e)}S(t){this._$AH!==t&&(this._$AR(),this._$AH=this.M(t))}$(t){this._$AH!==R&&S(this._$AH)?this._$AA.nextSibling.data=t:this.S(x.createTextNode(t)),this._$AH=t}T(t){var e;const{values:n,_$litType$:i}=t,r="number"==typeof i?this._$AC(t):(void 0===i.el&&(i.el=D.createElement(i.h,this.options)),i);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.m(n);else{const t=new I(r,this),e=t.p(this.options);t.m(n),this.S(e),this._$AH=t}}_$AC(t){let e=M.get(t.strings);return void 0===e&&M.set(t.strings,e=new D(t)),e}A(t){E(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const r of t)i===e.length?e.push(n=new H(this.M(_()),this.M(_()),this,this.options)):n=e[i],n._$AI(r),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cg=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class V{constructor(t,e,n,i,r){this.type=1,this._$AH=R,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=R}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,n,i){const r=this.strings;let o=!1;if(void 0===r)t=z(this,t,e,0),o=!S(t)||t!==this._$AH&&t!==U,o&&(this._$AH=t);else{const i=t;let a,s;for(t=r[0],a=0;a<r.length-1;a++)s=z(this,i[n+a],e,a),s===U&&(s=this._$AH[a]),o||(o=!S(s)||s!==this._$AH[a]),s===R?t=R:t!==R&&(t+=(null!=s?s:"")+r[a+1]),this._$AH[a]=s}o&&!i&&this.k(t)}k(t){t===R?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:"")}}class B extends V{constructor(){super(...arguments),this.type=3}k(t){this.element[this.name]=t===R?void 0:t}}const F=y?y.emptyScript:"";class J extends V{constructor(){super(...arguments),this.type=4}k(t){t&&t!==R?this.element.setAttribute(this.name,F):this.element.removeAttribute(this.name)}}class q extends V{constructor(t,e,n,i,r){super(t,e,n,i,r),this.type=5}_$AI(t,e=this){var n;if((t=null!==(n=z(this,t,e,0))&&void 0!==n?n:R)===U)return;const i=this._$AH,r=t===R&&i!==R||t.capture!==i.capture||t.once!==i.once||t.passive!==i.passive,o=t!==R&&(i===R||r);r&&this.element.removeEventListener(this.name,this,i),o&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==n?n:this.element,t):this._$AH.handleEvent(t)}}class G{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){z(this,t)}}const W=window.litHtmlPolyfillSupport;
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var X,Y;null==W||W(D,H),(null!==(v=globalThis.litHtmlVersions)&&void 0!==v?v:globalThis.litHtmlVersions=[]).push("2.1.1");class K extends p{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var t,e;const n=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=n.firstChild),n}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Dt=((t,e,n)=>{var i,r;const o=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:e;let a=o._$litPart$;if(void 0===a){const t=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:null;o._$litPart$=a=new H(e.insertBefore(_(),t),t,void 0,null!=n?n:{})}return a._$AI(t),a})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Dt)||void 0===t||t.setConnected(!1)}render(){return U}}K.finalized=!0,K._$litElement$=!0,null===(X=globalThis.litElementHydrateSupport)||void 0===X||X.call(globalThis,{LitElement:K});const Z=globalThis.litElementPolyfillSupport;null==Z||Z({LitElement:K}),(null!==(Y=globalThis.litElementVersions)&&void 0!==Y?Y:globalThis.litElementVersions=[]).push("3.1.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const Q=t=>e=>"function"==typeof e?((t,e)=>(window.customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:n,elements:i}=e;return{kind:n,elements:i,finisher(e){window.customElements.define(t,e)}}})(t,e)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,tt=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?{...e,finisher(n){n.createProperty(e.key,t)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:e.key,initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function et(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):tt(t,e)}
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var nt;null===(nt=window.HTMLSlotElement)||void 0===nt||nt.prototype.assignedElements;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var it=function(){return it=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},it.apply(this,arguments)};function rt(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function ot(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function at(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a}function st(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var ct={};function lt(t){return Object.keys(t)}function ut(t,e,n){void 0===n&&(n=".");var i=ft(t,n),r=ft(e,n);return Tt(r)?!!Tt(i)&&r===i:Tt(i)?i in r:lt(i).every((function(t){return t in r&&ut(i[t],r[t])}))}function ht(t){try{return Tt(t)||"number"==typeof t?"".concat(t):t.type}catch(t){throw new Error("Events must be strings or objects with a string event.type property.")}}function dt(t,e){try{return kt(t)?t:t.toString().split(e)}catch(e){throw new Error("'".concat(t,"' is not a valid state path."))}}function ft(t,e){return"object"==typeof(n=t)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?t.value:kt(t)?pt(t):"string"!=typeof t?t:pt(dt(t,e));var n}function pt(t){if(1===t.length)return t[0];for(var e={},n=e,i=0;i<t.length-1;i++)i===t.length-2?n[t[i]]=t[i+1]:(n[t[i]]={},n=n[t[i]]);return e}function vt(t,e){for(var n={},i=lt(t),r=0;r<i.length;r++){var o=i[r];n[o]=e(t[o],o,t,r)}return n}function yt(t,e,n){var i,r,o={};try{for(var a=ot(lt(t)),s=a.next();!s.done;s=a.next()){var c=s.value,l=t[c];n(l)&&(o[c]=e(l,c,t))}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}var gt=function(t){return function(e){var n,i,r=e;try{for(var o=ot(t),a=o.next();!a.done;a=o.next()){r=r[a.value]}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return r}};function mt(t){return t?Tt(t)?[[t]]:wt(lt(t).map((function(e){var n=t[e];return"string"==typeof n||n&&Object.keys(n).length?mt(t[e]).map((function(t){return[e].concat(t)})):[[e]]}))):[[]]}function wt(t){var e;return(e=[]).concat.apply(e,st([],at(t),!1))}function bt(t){return kt(t)?t:[t]}function xt(t){return void 0===t?[]:bt(t)}function _t(t,e,n){var i,r;if(Pt(t))return t(e,n.data);var o={};try{for(var a=ot(Object.keys(t)),s=a.next();!s.done;s=a.next()){var c=s.value,l=t[c];Pt(l)?o[c]=l(e,n.data):o[c]=l}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function St(t){return t instanceof Promise||!(null===t||!Pt(t)&&"object"!=typeof t||!Pt(t.then))}function Et(t,e){var n,i,r=at([[],[]],2),o=r[0],a=r[1];try{for(var s=ot(t),c=s.next();!c.done;c=s.next()){var l=c.value;e(l)?o.push(l):a.push(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return[o,a]}function $t(t,e){return vt(t.states,(function(t,n){if(t){var i=(Tt(e)?void 0:e[n])||(t?t.current:void 0);if(i)return{current:i,states:$t(t,i)}}}))}function At(t,e,n,i){return Ct(!!t,"Attempting to update undefined context"),t?n.reduce((function(t,n){var r,o,a=n.assignment,s={state:i,action:n,_event:e},c={};if(Pt(a))c=a(t,e.data,s);else try{for(var l=ot(lt(a)),u=l.next();!u.done;u=l.next()){var h=u.value,d=a[h];c[h]=Pt(d)?d(t,e.data,s):d}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return Object.assign({},t,c)}),t):t}var Ct=function(){};function kt(t){return Array.isArray(t)}function Pt(t){return"function"==typeof t}function Tt(t){return"string"==typeof t}function Nt(t,e){if(t)return Tt(t)?{type:"xstate.guard",name:t,predicate:e?e[t]:void 0}:Pt(t)?{type:"xstate.guard",name:t.name,predicate:t}:t}Ct=function(t,e){var n=t instanceof Error?t:void 0;if((n||!t)&&void 0!==console){var i=["Warning: ".concat(e)];n&&i.push(n),console.warn.apply(console,i)}};var Ot,Ut,Rt=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Mt(t){try{return"__xstatenode"in t}catch(t){return!1}}function Lt(t,e){return Tt(t)||"number"==typeof t?it({type:t},e):t}function jt(t,e){if(!Tt(t)&&"$$type"in t&&"scxml"===t.$$type)return t;var n=Lt(t);return it({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function Dt(t,e){return bt(e).map((function(e){return void 0===e||"string"==typeof e||Mt(e)?{target:e,event:t}:it(it({},e),{event:t})}))}function zt(t,e,n,i,r){var o=t.options.guards,a={state:r,cond:e,_event:i};if("xstate.guard"===e.type)return((null==o?void 0:o[e.name])||e.predicate)(n,i.data,a);var s=o[e.type];if(!s)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return s(n,i.data,a)}function It(t){return"string"==typeof t?{type:t}:t}function Ht(t,e,n){if("object"==typeof t)return t;var i=function(){};return{next:t,error:e||i,complete:n||i}}!function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"}(Ot||(Ot={})),function(t){t.Parent="#_parent",t.Internal="#_internal"}(Ut||(Ut={}));var Vt=Ot.Start,Bt=Ot.Stop,Ft=Ot.Raise,Jt=Ot.Send,qt=Ot.Cancel,Gt=Ot.NullEvent,Wt=Ot.Assign;Ot.After,Ot.DoneState;var Xt=Ot.Log,Yt=Ot.Init,Kt=Ot.Invoke;Ot.ErrorExecution;var Zt=Ot.ErrorPlatform,Qt=Ot.ErrorCustom,te=Ot.Update,ee=Ot.Choose,ne=Ot.Pure,ie=jt({type:Yt});function re(t,e){return e&&e[t]||void 0}function oe(t,e){var n;if(Tt(t)||"number"==typeof t)n=Pt(i=re(t,e))?{type:t,exec:i}:i||{type:t,exec:void 0};else if(Pt(t))n={type:t.name||t.toString(),exec:t};else{var i;if(Pt(i=re(t.type,e)))n=it(it({},t),{exec:i});else if(i){var r=i.type||t.type;n=it(it(it({},i),t),{type:r})}else n=t}return n}var ae=function(t,e){return t?(kt(t)?t:[t]).map((function(t){return oe(t,e)})):[]};function se(t){var e=oe(t);return it(it({id:Tt(t)?t:e.id},e),{type:e.type})}function ce(t){return Tt(t)?{type:Ft,event:t}:le(t,{to:Ut.Internal})}function le(t,e){return{to:e?e.to:void 0,type:Jt,event:Pt(t)?t:Lt(t),delay:e?e.delay:void 0,id:e&&void 0!==e.id?e.id:Pt(t)?t.name:ht(t)}}function ue(t,e){return le(t,it(it({},e),{to:Ut.Parent}))}var he=function(t,e){return{context:t,event:e}};var de=function(t){return{type:qt,sendId:t}};function fe(t){var e=se(t);return{type:Ot.Start,activity:e,exec:void 0}}function pe(t){var e=Pt(t)?t:se(t);return{type:Ot.Stop,activity:e,exec:void 0}}var ve=function(t){return{type:Wt,assignment:t}};function ye(t,e){var n=e?"#".concat(e):"";return"".concat(Ot.After,"(").concat(t,")").concat(n)}function ge(t,e){var n="".concat(Ot.DoneState,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function me(t,e){var n="".concat(Ot.DoneInvoke,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function we(t,e){var n="".concat(Ot.ErrorPlatform,".").concat(t),i={type:n,data:e,toString:function(){return n}};return i}function be(t,e,n,i,r,o){void 0===o&&(o=!1);var a=at(o?[[],r]:Et(r,(function(t){return t.type===Wt})),2),s=a[0],c=a[1],l=s.length?At(n,i,s,e):n,u=o?[n]:void 0,h=wt(c.map((function(n){var r;switch(n.type){case Ft:return{type:Ft,_event:jt(n.event)};case Jt:var a=function(t,e,n,i){var r,o={_event:n},a=jt(Pt(t.event)?t.event(e,n.data,o):t.event);if(Tt(t.delay)){var s=i&&i[t.delay];r=Pt(s)?s(e,n.data,o):s}else r=Pt(t.delay)?t.delay(e,n.data,o):t.delay;var c=Pt(t.to)?t.to(e,n.data,o):t.to;return it(it({},t),{to:c,_event:a,event:a.data,delay:r})}(n,l,i,t.options.delays);return Ct(!Tt(n.delay)||"number"==typeof a.delay,"No delay reference for delay expression '".concat(n.delay,"' was found on machine '").concat(t.id,"'")),a;case Xt:return function(t,e,n){return it(it({},t),{value:Tt(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})}(n,l,i);case ee:if(!(d=null===(r=n.conds.find((function(n){var r=Nt(n.cond,t.options.guards);return!r||zt(t,r,l,i,e)})))||void 0===r?void 0:r.actions))return[];var s=at(be(t,e,l,i,ae(xt(d),t.options.actions),o),2),c=s[0],h=s[1];return l=h,null==u||u.push(l),c;case ne:var d;if(!(d=n.get(l,i.data)))return[];var f=at(be(t,e,l,i,ae(xt(d),t.options.actions),o),2),p=f[0],v=f[1];return l=v,null==u||u.push(l),p;case Bt:return function(t,e,n){var i=Pt(t.activity)?t.activity(e,n.data):t.activity,r="string"==typeof i?{id:i}:i;return{type:Ot.Stop,activity:r}}(n,l,i);case Wt:l=At(l,i,[n],e),null==u||u.push(l);break;default:var y=oe(n,t.options.actions),g=y.exec;if(g&&u){var m=u.length-1;y=it(it({},y),{exec:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];g.apply(void 0,st([u[m]],at(e),!1))}})}return y}})).filter((function(t){return!!t})));return[h,l]}var xe=function(t){return"atomic"===t.type||"final"===t.type};function _e(t){return lt(t.states).map((function(e){return t.states[e]}))}function Se(t){var e=[t];return xe(t)?e:e.concat(wt(_e(t).map(Se)))}function Ee(t,e){var n,i,r,o,a,s,c,l,u=Ae(new Set(t)),h=new Set(e);try{for(var d=ot(h),f=d.next();!f.done;f=d.next())for(var p=(S=f.value).parent;p&&!h.has(p);)h.add(p),p=p.parent}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}var v=Ae(h);try{for(var y=ot(h),g=y.next();!g.done;g=y.next()){if("compound"!==(S=g.value).type||v.get(S)&&v.get(S).length){if("parallel"===S.type)try{for(var m=(a=void 0,ot(_e(S))),w=m.next();!w.done;w=m.next()){var b=w.value;"history"!==b.type&&(h.has(b)||(h.add(b),u.get(b)?u.get(b).forEach((function(t){return h.add(t)})):b.initialStateNodes.forEach((function(t){return h.add(t)}))))}}catch(t){a={error:t}}finally{try{w&&!w.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}else u.get(S)?u.get(S).forEach((function(t){return h.add(t)})):S.initialStateNodes.forEach((function(t){return h.add(t)}))}}catch(t){r={error:t}}finally{try{g&&!g.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}try{for(var x=ot(h),_=x.next();!_.done;_=x.next()){var S;for(p=(S=_.value).parent;p&&!h.has(p);)h.add(p),p=p.parent}}catch(t){c={error:t}}finally{try{_&&!_.done&&(l=x.return)&&l.call(x)}finally{if(c)throw c.error}}return h}function $e(t,e){var n=e.get(t);if(!n)return{};if("compound"===t.type){var i=n[0];if(!i)return{};if(xe(i))return i.key}var r={};return n.forEach((function(t){r[t.key]=$e(t,e)})),r}function Ae(t){var e,n,i=new Map;try{for(var r=ot(t),o=r.next();!o.done;o=r.next()){var a=o.value;i.has(a)||i.set(a,[]),a.parent&&(i.has(a.parent)||i.set(a.parent,[]),i.get(a.parent).push(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Ce(t,e){return $e(t,Ae(Ee([t],e)))}function ke(t,e){return Array.isArray(t)?t.some((function(t){return t===e})):t instanceof Set&&t.has(e)}function Pe(t,e){return"compound"===e.type?_e(e).some((function(e){return"final"===e.type&&ke(t,e)})):"parallel"===e.type&&_e(e).every((function(e){return Pe(t,e)}))}function Te(t){return new Set(wt(t.map((function(t){return t.tags}))))}function Ne(t,e){if(t===e)return!0;if(void 0===t||void 0===e)return!1;if(Tt(t)||Tt(e))return t===e;var n=lt(t),i=lt(e);return n.length===i.length&&n.every((function(n){return Ne(t[n],e[n])}))}var Oe=function(){function t(t){var e,n,i=this;this.actions=[],this.activities=ct,this.meta={},this.events=[],this.value=t.value,this.context=t.context,this._event=t._event,this._sessionid=t._sessionid,this.event=this._event.data,this.historyValue=t.historyValue,this.history=t.history,this.actions=t.actions||[],this.activities=t.activities||ct,this.meta=(void 0===(n=t.configuration)&&(n=[]),n.reduce((function(t,e){return void 0!==e.meta&&(t[e.id]=e.meta),t}),{})),this.events=t.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=t.configuration,this.transitions=t.transitions,this.children=t.children,this.done=!!t.done,this.tags=null!==(e=Array.isArray(t.tags)?new Set(t.tags):t.tags)&&void 0!==e?e:new Set,this.machine=t.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(t){return st([],at(new Set(wt(st([],at(t.map((function(t){return t.ownEvents}))),!1)))),!1)}(i.configuration)}})}return t.from=function(e,n){return e instanceof t?e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e:new t({value:e,context:n,_event:ie,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var i=ie;return new t({value:e.value,context:n,_event:i,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(t,e){var n=this;if(void 0===t&&(t=this.value),void 0===e&&(e="."),Tt(t))return[t];var i=lt(t);return i.concat.apply(i,st([],at(i.map((function(i){return n.toStrings(t[i],e).map((function(t){return i+e+t}))}))),!1))},t.prototype.toJSON=function(){var t=this;t.configuration,t.transitions;var e=t.tags;t.machine;var n=rt(t,["configuration","transitions","tags","machine"]);return it(it({},n),{tags:Array.from(e)})},t.prototype.matches=function(t){return ut(t,this.value)},t.prototype.hasTag=function(t){return this.tags.has(t)},t.prototype.can=function(t){var e,n=null===(e=this.machine)||void 0===e?void 0:e.getTransitionData(this,t);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},t}(),Ue=function(t,e){return e(t)};function Re(t){return{id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}}}function Me(t,e,n,i){var r,o=It(t.src),a=null===(r=null==e?void 0:e.options.services)||void 0===r?void 0:r[o.type],s=t.data?_t(t.data,n,i):void 0,c=a?function(t,e,n){var i=Re(e);if(i.deferred=!0,Mt(t)){var r=i.state=Ue(void 0,(function(){return(n?t.withContext(n):t).initialState}));i.getSnapshot=function(){return r}}return i}(a,t.id,s):Re(t.id);return c.meta=t,c}function Le(t){if("string"==typeof t){var e={type:t,toString:function(){return t}};return e}return t}function je(t){return it(it({type:Kt},t),{toJSON:function(){t.onDone,t.onError;var e=rt(t,["onDone","onError"]);return it(it({},e),{type:Kt,src:Le(t.src)})}})}var De={},ze=function(t){return"#"===t[0]},Ie=function(){function t(e,n,i){var r,o=this;void 0===i&&(i="context"in e?e.context:void 0),this.config=e,this._context=i,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=this.options._parent,this.key=this.config.key||this.options._key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||st([this.machine.key],at(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&lt(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(r=this.config.schema)&&void 0!==r?r:{},this.description=this.config.description,Ct(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?vt(this.config.states,(function(e,n){var i,r=new t(e,{_parent:o,_key:n});return Object.assign(o.idMap,it(((i={})[r.id]=r,i),r.idMap)),r})):De;var a=0;!function t(e){var n,i;e.order=a++;try{for(var r=ot(_e(e)),o=r.next();!o.done;o=r.next()){t(o.value)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(t){return""===t.event})):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=xt(this.config.entry||this.config.onEntry).map((function(t){return oe(t)})),this.onExit=xt(this.config.exit||this.config.onExit).map((function(t){return oe(t)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=xt(this.config.invoke).map((function(t,e){var n,i;if(Mt(t))return o.machine.options.services=it(((n={})[t.id]=t,n),o.machine.options.services),je({src:t.id,id:t.id});if(Tt(t.src))return je(it(it({},t),{id:t.id||t.src,src:t.src}));if(Mt(t.src)||Pt(t.src)){var r="".concat(o.id,":invocation[").concat(e,"]");return o.machine.options.services=it(((i={})[r]=t.src,i),o.machine.options.services),je(it(it({id:r},t),{src:r}))}var a=t.src;return je(it(it({id:a.type},t),{src:a}))})),this.activities=xt(this.config.activities).concat(this.invoke).map((function(t){return se(t)})),this.transition=this.transition.bind(this),this.tags=xt(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Se(this).forEach((function(t){return t.on}))},t.prototype.withConfig=function(e,n){var i=this.options,r=i.actions,o=i.activities,a=i.guards,s=i.services,c=i.delays;return new t(this.config,{actions:it(it({},r),e.actions),activities:it(it({},o),e.activities),guards:it(it({},a),e.guards),services:it(it({},s),e.services),delays:it(it({},c),e.delays)},null!=n?n:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return Pt(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:vt(this.states,(function(t){return t.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var t=this.transitions;return this.__cache.on=t.reduce((function(t,e){return t[e.eventType]=t[e.eventType]||[],t[e.eventType].push(e),t}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(t){if(this.__cache.candidates[t])return this.__cache.candidates[t];var e=""===t,n=this.transitions.filter((function(n){var i=n.eventType===t;return e?i:i||"*"===n.eventType}));return this.__cache.candidates[t]=n,n},t.prototype.getDelayedTransitions=function(){var t=this,e=this.config.after;if(!e)return[];var n=function(e,n){var i=ye(Pt(e)?"".concat(t.id,":delay[").concat(n,"]"):e,t.id);return t.onEntry.push(le(i,{delay:e})),t.onExit.push(de(i)),i},i=kt(e)?e.map((function(t,e){var i=n(t.delay,e);return it(it({},t),{event:i})})):wt(lt(e).map((function(t,i){var r=e[t],o=Tt(r)?{target:r}:r,a=isNaN(+t)?t:+t,s=n(a,i);return xt(o).map((function(t){return it(it({},t),{event:s,delay:a})}))})));return i.map((function(e){var n=e.delay;return it(it({},t.formatTransition(e)),{delay:n})}))},t.prototype.getStateNodes=function(t){var e,n=this;if(!t)return[];var i=t instanceof Oe?t.value:ft(t,this.delimiter);if(Tt(i)){var r=this.getStateNode(i).initial;return void 0!==r?this.getStateNodes(((e={})[i]=r,e)):[this,this.states[i]]}var o=lt(i),a=[this];return a.push.apply(a,st([],at(wt(o.map((function(t){return n.getStateNode(t).getStateNodes(i[t])})))),!1)),a},t.prototype.handles=function(t){var e=ht(t);return this.events.includes(e)},t.prototype.resolveState=function(t){var e=Array.from(Ee([],this.getStateNodes(t.value)));return new Oe(it(it({},t),{value:this.resolve(t.value),configuration:e,done:Pe(e,this),tags:Te(e)}))},t.prototype.transitionLeafNode=function(t,e,n){var i=this.getStateNode(t).next(e,n);return i&&i.transitions.length?i:this.next(e,n)},t.prototype.transitionCompoundNode=function(t,e,n){var i=lt(t),r=this.getStateNode(i[0])._transition(t[i[0]],e,n);return r&&r.transitions.length?r:this.next(e,n)},t.prototype.transitionParallelNode=function(t,e,n){var i,r,o={};try{for(var a=ot(lt(t)),s=a.next();!s.done;s=a.next()){var c=s.value,l=t[c];if(l){var u=this.getStateNode(c)._transition(l,e,n);u&&(o[c]=u)}}}catch(t){i={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}var h=lt(o).map((function(t){return o[t]})),d=wt(h.map((function(t){return t.transitions})));if(!h.some((function(t){return t.transitions.length>0})))return this.next(e,n);var f=wt(h.map((function(t){return t.entrySet}))),p=wt(lt(o).map((function(t){return o[t].configuration})));return{transitions:d,entrySet:f,exitSet:wt(h.map((function(t){return t.exitSet}))),configuration:p,source:e,actions:wt(lt(o).map((function(t){return o[t].actions})))}},t.prototype._transition=function(t,e,n){return Tt(t)?this.transitionLeafNode(t,e,n):1===lt(t).length?this.transitionCompoundNode(t,e,n):this.transitionParallelNode(t,e,n)},t.prototype.getTransitionData=function(t,e){return this._transition(t.value,t,jt(e))},t.prototype.next=function(t,e){var n,i,r,o=this,a=e.name,s=[],c=[];try{for(var l=ot(this.getCandidates(a)),u=l.next();!u.done;u=l.next()){var h=u.value,d=h.cond,f=h.in,p=t.context,v=!f||(Tt(f)&&ze(f)?t.matches(ft(this.getStateNodeById(f).path,this.delimiter)):ut(ft(f,this.delimiter),gt(this.path.slice(0,-2))(t.value))),y=!1;try{y=!d||zt(this.machine,d,p,e,t)}catch(t){throw new Error("Unable to evaluate guard '".concat(d.name||d.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,"':\n").concat(t.message))}if(y&&v){void 0!==h.target&&(c=h.target),s.push.apply(s,st([],at(h.actions),!1)),r=h;break}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}if(r){if(!c.length)return{transitions:[r],entrySet:[],exitSet:[],configuration:t.value?[this]:[],source:t,actions:s};var g=wt(c.map((function(e){return o.getRelativeStateNodes(e,t.historyValue)}))),m=!!r.internal,w=m?[]:wt(g.map((function(t){return o.nodesFromChild(t)})));return{transitions:[r],entrySet:w,exitSet:m?[]:[this],configuration:g,source:t,actions:s}}},t.prototype.nodesFromChild=function(t){if(t.escapes(this))return[];for(var e=[],n=t;n&&n!==this;)e.push(n),n=n.parent;return e.push(this),e},t.prototype.escapes=function(t){if(this===t)return!1;for(var e=this.parent;e;){if(e===t)return!1;e=e.parent}return!0},t.prototype.getActions=function(t,e,n,i){var r,o,a,s,c=Ee([],i?this.getStateNodes(i.value):[this]),l=t.configuration.length?Ee(c,t.configuration):c;try{for(var u=ot(l),h=u.next();!h.done;h=u.next()){ke(c,p=h.value)||t.entrySet.push(p)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}try{for(var d=ot(c),f=d.next();!f.done;f=d.next()){var p;ke(l,p=f.value)&&!ke(t.exitSet,p.parent)||t.exitSet.push(p)}}catch(t){a={error:t}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}var v=wt(t.entrySet.map((function(i){var r=[];if("final"!==i.type)return r;var o=i.parent;if(!o.parent)return r;r.push(ge(i.id,i.doneData),ge(o.id,i.doneData?_t(i.doneData,e,n):void 0));var a=o.parent;return"parallel"===a.type&&_e(a).every((function(e){return Pe(t.configuration,e)}))&&r.push(ge(a.id)),r})));t.exitSet.sort((function(t,e){return e.order-t.order})),t.entrySet.sort((function(t,e){return t.order-e.order}));var y=new Set(t.entrySet),g=new Set(t.exitSet),m=at([wt(Array.from(y).map((function(t){return st(st([],at(t.activities.map((function(t){return fe(t)}))),!1),at(t.onEntry),!1)}))).concat(v.map(ce)),wt(Array.from(g).map((function(t){return st(st([],at(t.onExit),!1),at(t.activities.map((function(t){return pe(t)}))),!1)})))],2),w=m[0],b=m[1];return ae(b.concat(t.actions).concat(w),this.machine.options.actions)},t.prototype.transition=function(t,e,n){void 0===t&&(t=this.initialState);var i,r,o=jt(e);if(t instanceof Oe)i=void 0===n?t:this.resolveState(Oe.from(t,n));else{var a=Tt(t)?this.resolve(pt(this.getResolvedPath(t))):this.resolve(t),s=null!=n?n:this.machine.context;i=this.resolveState(Oe.from(a,s))}if("*"===o.name)throw new Error("An event cannot have the wildcard type ('".concat("*","')"));if(this.strict&&!this.events.includes(o.name)&&(r=o.name,!/^(done|error)\./.test(r)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var c=this._transition(i.value,i,o)||{transitions:[],configuration:[],entrySet:[],exitSet:[],source:i,actions:[]},l=Ee([],this.getStateNodes(i.value)),u=c.configuration.length?Ee(l,c.configuration):l;return c.configuration=st([],at(u),!1),this.resolveTransition(c,i,o)},t.prototype.resolveRaisedTransition=function(t,e,n){var i,r=t.actions;return(t=this.transition(t,e))._event=n,t.event=n.data,(i=t.actions).unshift.apply(i,st([],at(r),!1)),t},t.prototype.resolveTransition=function(t,e,n,i){var r,o,a=this;void 0===n&&(n=ie),void 0===i&&(i=this.machine.context);var s=t.configuration,c=!e||t.transitions.length>0,l=c?Ce(this.machine,s):void 0,u=e?e.historyValue?e.historyValue:t.source?this.machine.historyValue(e.value):void 0:void 0,h=e?e.context:i,d=this.getActions(t,h,n,e),f=e?it({},e.activities):{};try{for(var p=ot(d),v=p.next();!v.done;v=p.next()){var y=v.value;y.type===Vt?f[y.activity.id||y.activity.type]=y:y.type===Bt&&(f[y.activity.id||y.activity.type]=!1)}}catch(t){r={error:t}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}var g,m,w=at(be(this,e,h,n,d,this.machine.config.preserveActionOrder),2),b=w[0],x=w[1],_=at(Et(b,(function(t){return t.type===Ft||t.type===Jt&&t.to===Ut.Internal})),2),S=_[0],E=_[1],$=b.filter((function(t){var e;return t.type===Vt&&(null===(e=t.activity)||void 0===e?void 0:e.type)===Kt})),A=$.reduce((function(t,e){return t[e.activity.id]=Me(e.activity,a.machine,x,n),t}),e?it({},e.children):{}),C=l?t.configuration:e?e.configuration:[],k=Pe(C,this),P=new Oe({value:l||e.value,context:x,_event:n,_sessionid:e?e._sessionid:null,historyValue:l?u?(g=u,m=l,{current:m,states:$t(g,m)}):void 0:e?e.historyValue:void 0,history:!l||t.source?e:void 0,actions:l?E:[],activities:l?f:e?e.activities:{},events:[],configuration:C,transitions:t.transitions,children:A,done:k,tags:null==e?void 0:e.tags,machine:this}),T=h!==x;P.changed=n.name===te||T;var N=P.history;N&&delete N.history;var O=!k&&(this._transient||s.some((function(t){return t._transient})));if(!(c||O&&""!==n.name))return P;var U=P;if(!k)for(O&&(U=this.resolveRaisedTransition(U,{type:Gt},n));S.length;){var R=S.shift();U=this.resolveRaisedTransition(U,R._event,n)}var M=U.changed||(N?!!U.actions.length||T||typeof N.value!=typeof U.value||!Ne(U.value,N.value):void 0);return U.changed=M,U.history=N,U.tags=Te(U.configuration),U},t.prototype.getStateNode=function(t){if(ze(t))return this.machine.getStateNodeById(t);if(!this.states)throw new Error("Unable to retrieve child state '".concat(t,"' from '").concat(this.id,"'; no child states exist."));var e=this.states[t];if(!e)throw new Error("Child state '".concat(t,"' does not exist on '").concat(this.id,"'"));return e},t.prototype.getStateNodeById=function(t){var e=ze(t)?t.slice("#".length):t;if(e===this.id)return this;var n=this.machine.idMap[e];if(!n)throw new Error("Child state node '#".concat(e,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(t){if("string"==typeof t&&ze(t))try{return this.getStateNodeById(t.slice(1))}catch(t){}for(var e=dt(t,this.delimiter).slice(),n=this;e.length;){var i=e.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(t){var e,n=this;if(!t)return this.initialStateValue||De;switch(this.type){case"parallel":return vt(this.initialStateValue,(function(e,i){return e?n.getStateNode(i).resolve(t[i]||e):De}));case"compound":if(Tt(t)){var i=this.getStateNode(t);return"parallel"===i.type||"compound"===i.type?((e={})[t]=i.initialStateValue,e):t}return lt(t).length?vt(t,(function(t,e){return t?n.getStateNode(e).resolve(t):De})):this.initialStateValue||{};default:return t||De}},t.prototype.getResolvedPath=function(t){if(ze(t)){var e=this.machine.idMap[t.slice("#".length)];if(!e)throw new Error("Unable to find state node '".concat(t,"'"));return e.path}return dt(t,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var t,e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)e=yt(this.states,(function(t){return t.initialStateValue||De}),(function(t){return!("history"===t.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));e=xe(this.states[this.initial])?this.initial:((t={})[this.initial]=this.states[this.initial].initialStateValue,t)}else e={};return this.__cache.initialStateValue=e,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(t,e){var n=this.getStateNodes(t);return this.resolveTransition({configuration:n,entrySet:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,void 0,e)},Object.defineProperty(t.prototype,"initialState",{get:function(){this._init();var t=this.initialStateValue;if(!t)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var t;if("history"===this.type){var e=this.config;t=Tt(e.target)&&ze(e.target)?pt(this.machine.getStateNodeById(e.target).path.slice(this.path.length-1)):e.target}return t},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(t,e,n){return void 0===n&&(n=!0),n?"history"===t.type?t.resolveHistory(e):t.initialStateNodes:[t]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var t=this;return xe(this)?[this]:"compound"!==this.type||this.initial?wt(mt(this.initialStateValue).map((function(e){return t.getFromRelativePath(e)}))):(Ct(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(t){if(!t.length)return[this];var e=at(t),n=e[0],i=e.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var r=this.getStateNode(n);if("history"===r.type)return r.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(t){if(lt(this.states).length)return{current:t||this.initialStateValue,states:yt(this.states,(function(e,n){if(!t)return e.historyValue();var i=Tt(t)?void 0:t[n];return e.historyValue(i||e.initialStateValue)}),(function(t){return!t.history}))}},t.prototype.resolveHistory=function(t){var e=this;if("history"!==this.type)return[this];var n=this.parent;if(!t){var i=this.target;return i?wt(mt(i).map((function(t){return n.getFromRelativePath(t)}))):n.initialStateNodes}var r,o,a=(r=n.path,o="states",function(t){var e,n,i=t;try{for(var a=ot(r),s=a.next();!s.done;s=a.next()){var c=s.value;i=i[o][c]}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i})(t).current;return Tt(a)?[n.getStateNode(a)]:wt(mt(a).map((function(t){return"deep"===e.history?n.getFromRelativePath(t):[n.states[t[0]]]})))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var t=this,e=wt(lt(this.states).map((function(e){return t.states[e].stateIds})));return[this.id].concat(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var t,e,n,i;if(this.__cache.events)return this.__cache.events;var r=this.states,o=new Set(this.ownEvents);if(r)try{for(var a=ot(lt(r)),s=a.next();!s.done;s=a.next()){var c=r[s.value];if(c.states)try{for(var l=(n=void 0,ot(c.events)),u=l.next();!u.done;u=l.next()){var h=u.value;o.add("".concat(h))}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var t=new Set(this.transitions.filter((function(t){return!(!t.target&&!t.actions.length&&t.internal)})).map((function(t){return t.eventType})));return Array.from(t)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(t){var e=this;if(void 0!==t)return t.map((function(t){if(!Tt(t))return t;var n=t[0]===e.delimiter;if(n&&!e.parent)return e.getStateNodeByPath(t.slice(1));var i=n?e.key+t:t;if(!e.parent)return e.getStateNodeByPath(i);try{return e.parent.getStateNodeByPath(i)}catch(t){throw new Error("Invalid transition definition for state node '".concat(e.id,"':\n").concat(t.message))}}))},t.prototype.formatTransition=function(t){var e=this,n=function(t){if(void 0!==t&&""!==t)return xt(t)}(t.target),i="internal"in t?t.internal:!n||n.some((function(t){return Tt(t)&&t[0]===e.delimiter})),r=this.machine.options.guards,o=this.resolveTarget(n),a=it(it({},t),{actions:ae(xt(t.actions)),cond:Nt(t.cond,r),target:o,source:this,internal:i,eventType:t.event,toJSON:function(){return it(it({},a),{target:a.target?a.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(e.id)})}});return a},t.prototype.formatTransitions=function(){var t,e,n,i=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var r=this.config.on,o="*",a=r[o],s=void 0===a?[]:a,c=rt(r,["*"]);n=wt(lt(c).map((function(t){""===t&&Ct(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(i.id,'".'));var e=Dt(t,c[t]);return function(t,e,n){var i=n.slice(0,-1).some((function(t){return!("cond"in t)&&!("in"in t)&&(Tt(t.target)||Mt(t.target))})),r=""===e?"the transient event":"event '".concat(e,"'");Ct(!i,"One or more transitions for ".concat(r," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(i,t,e),e})).concat(Dt("*",s)))}else n=[];var l=this.config.always?Dt("",this.config.always):[],u=this.config.onDone?Dt(String(ge(this.id)),this.config.onDone):[];Ct(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var h=wt(this.invoke.map((function(t){var e=[];return t.onDone&&e.push.apply(e,st([],at(Dt(String(me(t.id)),t.onDone)),!1)),t.onError&&e.push.apply(e,st([],at(Dt(String(we(t.id)),t.onError)),!1)),e}))),d=this.after,f=wt(st(st(st(st([],at(u),!1),at(h),!1),at(n),!1),at(l),!1).map((function(t){return xt(t).map((function(t){return i.formatTransition(t)}))})));try{for(var p=ot(d),v=p.next();!v.done;v=p.next()){var y=v.value;f.push(y)}}catch(e){t={error:e}}finally{try{v&&!v.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}return f},t}();function He(t,e){return new Ie(t,e)}var Ve={deferEvents:!1},Be=function(){function t(t){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=it(it({},Ve),t)}return t.prototype.initialize=function(t){if(this.initialized=!0,t){if(!this.options.deferEvents)return void this.schedule(t);this.process(t)}this.flushEvents()},t.prototype.schedule=function(t){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(t),this.flushEvents()}else this.queue.push(t)},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var t=this.queue.shift();t;)this.process(t),t=this.queue.shift()},t.prototype.process=function(t){this.processingEvent=!0;try{t()}catch(t){throw this.clear(),t}finally{this.processingEvent=!1}},t}(),Fe=new Map,Je=0,qe=function(){return"x:".concat(Je++)},Ge=function(t,e){return Fe.set(t,e),t},We=function(t){return Fe.get(t)},Xe=function(t){Fe.delete(t)};function Ye(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function Ke(t){if(Ye()){var e=function(){var t=Ye();if(t&&"__xstate__"in t)return t.__xstate__}();e&&e.register(t)}}function Ze(t,e){void 0===e&&(e={});var n,i=t.initialState,r=new Set,o=[],a=!1,s=(n={id:e.id,send:function(e){o.push(e),function(){if(!a){for(a=!0;o.length>0;){var e=o.shift();i=t.transition(i,e,c),r.forEach((function(t){return t.next(i)}))}a=!1}}()},getSnapshot:function(){return i},subscribe:function(t,e,n){var o=Ht(t,e,n);return r.add(o),o.next(i),{unsubscribe:function(){r.delete(o)}}}},it({subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},n)),c={parent:e.parent,self:s,id:e.id||"anonymous",observers:r};return i=t.start?t.start(c):i,s}var Qe,tn={sync:!1,autoForward:!1};!function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(Qe||(Qe={}));var en=function(){function t(e,n){var i=this;void 0===n&&(n=t.defaultOptions),this.machine=e,this.scheduler=new Be,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Qe.NotStarted,this.children=new Map,this.forwardTo=new Set,this.init=this.start,this.send=function(t,e){if(kt(t))return i.batch(t),i.state;var n=jt(Lt(t,e));if(i.status===Qe.Stopped)return Ct(!1,'Event "'.concat(n.name,'" was sent to stopped service "').concat(i.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(n.data))),i.state;if(i.status!==Qe.Running&&!i.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(i.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return i.scheduler.schedule((function(){i.forward(n);var t=i.nextState(n);i.update(t,n)})),i._state},this.sendTo=function(t,e){var n,r=i.parent&&(e===Ut.Parent||i.parent.id===e),o=r?i.parent:Tt(e)?i.children.get(e)||We(e):(n=e)&&"function"==typeof n.send?e:void 0;if(o)"machine"in o?o.send(it(it({},t),{name:t.name===Qt?"".concat(we(i.id)):t.name,origin:i.sessionId})):o.send(t.data);else{if(!r)throw new Error("Unable to send event to child '".concat(e,"' from service '").concat(i.id,"'."));Ct(!1,"Service '".concat(i.id,"' has no parent: unable to send event ").concat(t.type))}};var r=it(it({},t.defaultOptions),n),o=r.clock,a=r.logger,s=r.parent,c=r.id,l=void 0!==c?c:e.id;this.id=l,this.logger=a,this.clock=o,this.parent=s,this.options=r,this.scheduler=new Be({deferEvents:this.options.deferEvents}),this.sessionId=qe()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var t=this;return this._initialState?this._initialState:Ue(this,(function(){return t._initialState=t.machine.initialState,t._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return Ct(this.status!==Qe.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(t,e){var n,i;try{for(var r=ot(t.actions),o=r.next();!o.done;o=r.next()){var a=o.value;this.exec(a,t,e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}},t.prototype.update=function(t,e){var n,i,r,o,a,s,c,l,u=this;if(t._sessionid=this.sessionId,this._state=t,this.options.execute&&this.execute(this.state),this.children.forEach((function(t){u.state.children[t.id]=t})),this.devTools&&this.devTools.send(e.data,t),t.event)try{for(var h=ot(this.eventListeners),d=h.next();!d.done;d=h.next()){(0,d.value)(t.event)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}try{for(var f=ot(this.listeners),p=f.next();!p.done;p=f.next()){(0,p.value)(t,t.event)}}catch(t){r={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}try{for(var v=ot(this.contextListeners),y=v.next();!y.done;y=v.next()){(0,y.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(t){a={error:t}}finally{try{y&&!y.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}var g=Pe(t.configuration||[],this.machine);if(this.state.configuration&&g){var m=t.configuration.find((function(t){return"final"===t.type&&t.parent===u.machine})),w=m&&m.doneData?_t(m.doneData,t.context,e):void 0;try{for(var b=ot(this.doneListeners),x=b.next();!x.done;x=b.next()){(0,x.value)(me(this.id,w))}}catch(t){c={error:t}}finally{try{x&&!x.done&&(l=b.return)&&l.call(b)}finally{if(c)throw c.error}}this.stop()}},t.prototype.onTransition=function(t){return this.listeners.add(t),this.status===Qe.Running&&t(this.state,this.state.event),this},t.prototype.subscribe=function(t,e,n){var i,r=this;if(!t)return{unsubscribe:function(){}};var o=n;return"function"==typeof t?i=t:(i=t.next.bind(t),o=t.complete.bind(t)),this.listeners.add(i),this.status===Qe.Running&&i(this.state),o&&this.onDone(o),{unsubscribe:function(){i&&r.listeners.delete(i),o&&r.doneListeners.delete(o)}}},t.prototype.onEvent=function(t){return this.eventListeners.add(t),this},t.prototype.onSend=function(t){return this.sendListeners.add(t),this},t.prototype.onChange=function(t){return this.contextListeners.add(t),this},t.prototype.onStop=function(t){return this.stopListeners.add(t),this},t.prototype.onDone=function(t){return this.doneListeners.add(t),this},t.prototype.off=function(t){return this.listeners.delete(t),this.eventListeners.delete(t),this.sendListeners.delete(t),this.stopListeners.delete(t),this.doneListeners.delete(t),this.contextListeners.delete(t),this},t.prototype.start=function(t){var e=this;if(this.status===Qe.Running)return this;Ge(this.sessionId,this),this.initialized=!0,this.status=Qe.Running;var n=void 0===t?this.initialState:Ue(this,(function(){return!Tt(n=t)&&"value"in n&&"history"in n?e.machine.resolveState(t):e.machine.resolveState(Oe.from(t,e.machine.context));var n}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){e.update(n,ie)})),this},t.prototype.stop=function(){var t,e,n,i,r,o,a,s,c,l,u=this;try{for(var h=ot(this.listeners),d=h.next();!d.done;d=h.next()){var f=d.value;this.listeners.delete(f)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}try{for(var p=ot(this.stopListeners),v=p.next();!v.done;v=p.next()){(f=v.value)(),this.stopListeners.delete(f)}}catch(t){n={error:t}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var y=ot(this.contextListeners),g=y.next();!g.done;g=y.next()){f=g.value;this.contextListeners.delete(f)}}catch(t){r={error:t}}finally{try{g&&!g.done&&(o=y.return)&&o.call(y)}finally{if(r)throw r.error}}try{for(var m=ot(this.doneListeners),w=m.next();!w.done;w=m.next()){f=w.value;this.doneListeners.delete(f)}}catch(t){a={error:t}}finally{try{w&&!w.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}if(!this.initialized)return this;this.state.configuration.forEach((function(t){var e,n;try{for(var i=ot(t.definition.exit),r=i.next();!r.done;r=i.next()){var o=r.value;u.exec(o,u.state)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}})),this.children.forEach((function(t){Pt(t.stop)&&t.stop()}));try{for(var b=ot(lt(this.delayedEventsMap)),x=b.next();!x.done;x=b.next()){var _=x.value;this.clock.clearTimeout(this.delayedEventsMap[_])}}catch(t){c={error:t}}finally{try{x&&!x.done&&(l=b.return)&&l.call(b)}finally{if(c)throw c.error}}return this.scheduler.clear(),this.initialized=!1,this.status=Qe.Stopped,Xe(this.sessionId),this},t.prototype.batch=function(t){var e=this;if(this.status===Qe.NotStarted&&this.options.deferEvents)Ct(!1,"".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==Qe.Running)throw new Error("".concat(t.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));this.scheduler.schedule((function(){var n,i,r=e.state,o=!1,a=[],s=function(t){var n=jt(t);e.forward(n),r=Ue(e,(function(){return e.machine.transition(r,n)})),a.push.apply(a,st([],at(r.actions.map((function(t){return n=r,i=(e=t).exec,it(it({},e),{exec:void 0!==i?function(){return i(n.context,n.event,{action:e,state:n,_event:n._event})}:void 0});var e,n,i}))),!1)),o=o||!!r.changed};try{for(var c=ot(t),l=c.next();!l.done;l=c.next()){s(l.value)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}r.changed=o,r.actions=a,e.update(r,jt(t[t.length-1]))}))},t.prototype.sender=function(t){return this.send.bind(this,t)},t.prototype.nextState=function(t){var e=this,n=jt(t);if(0===n.name.indexOf(Zt)&&!this.state.nextEvents.some((function(t){return 0===t.indexOf(Zt)})))throw n.data.data;return Ue(this,(function(){return e.machine.transition(e.state,n)}))},t.prototype.forward=function(t){var e,n;try{for(var i=ot(this.forwardTo),r=i.next();!r.done;r=i.next()){var o=r.value,a=this.children.get(o);if(!a)throw new Error("Unable to forward event '".concat(t,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));a.send(t)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.defer=function(t){var e=this;this.delayedEventsMap[t.id]=this.clock.setTimeout((function(){t.to?e.sendTo(t._event,t.to):e.send(t._event)}),t.delay)},t.prototype.cancel=function(t){this.clock.clearTimeout(this.delayedEventsMap[t]),delete this.delayedEventsMap[t]},t.prototype.exec=function(t,e,n){void 0===n&&(n=this.machine.options.actions);var i=e.context,r=e._event,o=t.exec||re(t.type,n),a=Pt(o)?o:o?o.exec:t.exec;if(a)try{return a(i,r.data,{action:t,state:this.state,_event:r})}catch(t){throw this.parent&&this.parent.send({type:"xstate.error",data:t}),t}switch(t.type){case Jt:var s=t;if("number"==typeof s.delay)return void this.defer(s);s.to?this.sendTo(s._event,s.to):this.send(s._event);break;case qt:this.cancel(t.sendId);break;case Vt:if(this.status!==Qe.Running)return;var c=t.activity;if(!this.state.activities[c.id||c.type])break;if(c.type===Ot.Invoke){var l=It(c.src),u=this.machine.options.services?this.machine.options.services[l.type]:void 0,h=c.id,d=c.data;Ct(!("forward"in c),"`forward` property is deprecated (found in invocation of '".concat(c.src,"' in in machine '").concat(this.machine.id,"'). ")+"Please use `autoForward` instead.");var f="autoForward"in c?c.autoForward:!!c.forward;if(!u)return void Ct(!1,"No service found for invocation '".concat(c.src,"' in machine '").concat(this.machine.id,"'."));var p=d?_t(d,i,r):void 0;if("string"==typeof u)return;var v=Pt(u)?u(i,r.data,{data:p,src:l,meta:c.meta}):u;if(!v)return;var y=void 0;Mt(v)&&(v=p?v.withContext(p):v,y={autoForward:f}),this.spawn(v,h,y)}else this.spawnActivity(c);break;case Bt:this.stopChild(t.activity.id);break;case Xt:var g=t.label,m=t.value;g?this.logger(g,m):this.logger(m);break;default:Ct(!1,"No implementation found for action type '".concat(t.type,"'"))}},t.prototype.removeChild=function(t){var e;this.children.delete(t),this.forwardTo.delete(t),null===(e=this.state)||void 0===e||delete e.children[t]},t.prototype.stopChild=function(t){var e=this.children.get(t);e&&(this.removeChild(t),Pt(e.stop)&&e.stop())},t.prototype.spawn=function(t,e,n){if(St(t))return this.spawnPromise(Promise.resolve(t),e);if(Pt(t))return this.spawnCallback(t,e);if(function(t){try{return"function"==typeof t.send}catch(t){return!1}}(r=t)&&"id"in r)return this.spawnActor(t,e);if(function(t){try{return"subscribe"in t&&Pt(t.subscribe)}catch(t){return!1}}(t))return this.spawnObservable(t,e);if(Mt(t))return this.spawnMachine(t,it(it({},n),{id:e}));if(null!==(i=t)&&"object"==typeof i&&"transition"in i&&"function"==typeof i.transition)return this.spawnBehavior(t,e);throw new Error('Unable to spawn entity "'.concat(e,'" of type "').concat(typeof t,'".'));var i,r},t.prototype.spawnMachine=function(e,n){var i=this;void 0===n&&(n={});var r=new t(e,it(it({},this.options),{parent:this,id:n.id||e.id})),o=it(it({},tn),n);o.sync&&r.onTransition((function(t){i.send(te,{state:t,id:r.id})}));var a=r;return this.children.set(r.id,a),o.autoForward&&this.forwardTo.add(r.id),r.onDone((function(t){i.removeChild(r.id),i.send(jt(t,{origin:r.id}))})).start(),a},t.prototype.spawnBehavior=function(t,e){var n=Ze(t,{id:e,parent:this});return this.children.set(e,n),n},t.prototype.spawnPromise=function(t,e){var n,i=this,r=!1;t.then((function(t){r||(n=t,i.removeChild(e),i.send(jt(me(e,t),{origin:e})))}),(function(t){if(!r){i.removeChild(e);var n=we(e,t);try{i.send(jt(n,{origin:e}))}catch(r){!function(t,e,n){var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(t,"'.").concat(i));else{var r=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(t,"'. ").concat(i," Current error is '").concat(e,"'.").concat(r))}}(t,r,e),i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var o={id:e,send:function(){},subscribe:function(e,n,i){var r=Ht(e,n,i),o=!1;return t.then((function(t){o||(r.next(t),o||r.complete())}),(function(t){o||r.error(t)})),{unsubscribe:function(){return o=!0}}},stop:function(){r=!0},toJSON:function(){return{id:e}},getSnapshot:function(){return n}};return this.children.set(e,o),o},t.prototype.spawnCallback=function(t,e){var n,i,r=this,o=!1,a=new Set,s=new Set;try{i=t((function(t){n=t,s.forEach((function(e){return e(t)})),o||r.send(jt(t,{origin:e}))}),(function(t){a.add(t)}))}catch(t){this.send(we(e,t))}if(St(i))return this.spawnPromise(i,e);var c={id:e,send:function(t){return a.forEach((function(e){return e(t)}))},subscribe:function(t){return s.add(t),{unsubscribe:function(){s.delete(t)}}},stop:function(){o=!0,Pt(i)&&i()},toJSON:function(){return{id:e}},getSnapshot:function(){return n}};return this.children.set(e,c),c},t.prototype.spawnObservable=function(t,e){var n,i=this,r=t.subscribe((function(t){n=t,i.send(jt(t,{origin:e}))}),(function(t){i.removeChild(e),i.send(jt(we(e,t),{origin:e}))}),(function(){i.removeChild(e),i.send(jt(me(e),{origin:e}))})),o={id:e,send:function(){},subscribe:function(e,n,i){return t.subscribe(e,n,i)},stop:function(){return r.unsubscribe()},getSnapshot:function(){return n},toJSON:function(){return{id:e}}};return this.children.set(e,o),o},t.prototype.spawnActor=function(t,e){return this.children.set(e,t),t},t.prototype.spawnActivity=function(t){var e=this.machine.options&&this.machine.options.activities?this.machine.options.activities[t.type]:void 0;if(e){var n=e(this.state.context,t);this.spawnEffect(t.id,n)}else Ct(!1,"No implementation found for activity '".concat(t.type,"'"))},t.prototype.spawnEffect=function(t,e){this.children.set(t,{id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:e||void 0,getSnapshot:function(){},toJSON:function(){return{id:t}}})},t.prototype.attachDev=function(){var t=Ye();if(this.options.devTools&&t){if(t.__REDUX_DEVTOOLS_EXTENSION__){var e="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=t.__REDUX_DEVTOOLS_EXTENSION__.connect(it(it({name:this.id,autoPause:!0,stateSanitizer:function(t){return{value:t.value,context:t.context,actions:t.actions}}},e),{features:it({jump:!1,skip:!1},e?e.features:void 0)}),this.machine),this.devTools.init(this.state)}Ke(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Rt]=function(){return this},t.prototype.getSnapshot=function(){return this.status===Qe.NotStarted?this.initialState:this._state},t.defaultOptions=function(t){return{execute:!0,deferEvents:!0,clock:{setTimeout:function(t,e){return setTimeout(t,e)},clearTimeout:function(t){return clearTimeout(t)}},logger:t.console.log.bind(console),devTools:!1}}("undefined"!=typeof self?self:global),t.interpret=nn,t}();function nn(t,e){return new en(t,e)}var rn={raise:ce,send:le,sendParent:ue,sendUpdate:function(){return ue(te)},log:function(t,e){return void 0===t&&(t=he),{type:Xt,label:e,expr:t}},cancel:de,start:fe,stop:pe,assign:ve,after:ye,done:ge,respond:function(t,e){return le(t,it(it({},e),{to:function(t,e,n){return n._event.origin}}))},forwardTo:function(t,e){return le((function(t,e){return e}),it(it({},e),{to:t}))},escalate:function(t,e){return ue((function(e,n,i){return{type:Qt,data:Pt(t)?t(e,n,i):t}}),it(it({},e),{to:Ut.Parent}))},choose:function(t){return{type:Ot.Choose,conds:t}},pure:function(t){return{type:Ot.Pure,get:t}}};const{pure:on}=rn,an=on(((t,e)=>[ve({cards:(t,e)=>{let n=!1;return t.cards.reduce(((t,e)=>n||e.dealt?[...t,e]:(n=!0,[...t,{...e,dealt:!0}])),[])}}),ue(((t,e)=>({type:"cardDealt",cards:t.cards})))])),sn=on(((t,e)=>[ve({userPicks:(t,e)=>[...t.userPicks,e.card],cards:(t,e)=>{const n=e.card;return t.cards.map(((t,e)=>e==n?{...t,revealed:!0}:t))}}),ue(((t,e)=>(e.card,{type:"cardRevealed",cards:t.cards})))])),cn=on(((t,e)=>[ve({userPicks:(t,e)=>[],cards:(t,e)=>t.cards.map(((e,n)=>t.userPicks.includes(n)?{...e,revealed:!1}:e))}),ue(((t,e)=>({type:"cardsHidden",cards:t.cards})))])),ln=on(((t,e)=>{const n=t.userPicks;return[ue(((t,e)=>({type:"correctPick",picks:n}))),ve({userPicks:(t,e)=>[]})]}));const un=He({id:"cardTableMachine",initial:"start",context:{cards:[],userPicks:[]},states:{start:{on:{tableComponentReady:{target:"dealing"}}},dealing:{always:[{target:"awaitCardPick",cond:"allCardsDealt"},{target:"dealCard"}]},dealCard:{entry:"dealCard",on:{dealAnimComplete:{target:"dealing"}}},awaitCardPick:{on:{cardPicked:[{cond:"pickedCardAlreadyRevealed"},{target:"revealCard"}]}},revealCard:{entry:"revealPickedCard",on:{revealAnimComplete:[{target:"correctPick",cond:"pickedCardsMatch"},{target:"hidePicked",cond:"maxCardsPicked"},{target:"awaitCardPick"}]}},correctPick:{entry:"processCorrectPick",on:{correctAnimComplete:[{target:"victory",cond:"allCardsMatched"},{target:"awaitCardPick"}]}},hidePicked:{entry:"hidePickedCards",on:{hideAnimComplete:{target:"awaitCardPick"}}},victory:{entry:ue("victory"),on:{victoryAnimComplete:{actions:ue("gameOver")}}}}},{actions:{dealCard:an,revealPickedCard:sn,hidePickedCards:cn,processCorrectPick:ln},guards:{allCardsDealt:function(t){return 0==t.cards.filter((t=>!t.dealt)).length},pickedCardAlreadyRevealed:function(t,e){return t.cards[e.card].revealed},maxCardsPicked:function(t,e){return t.userPicks.length>=2},pickedCardsMatch:function(t,e){return 2==t.userPicks.length&&1==new Set(t.userPicks.map((e=>t.cards[e].imageUrl))).size},allCardsMatched:function(t,e){return 0==t.cards.filter((t=>!t.revealed)).length}}}),{pure:hn}=rn;const dn=ve({catUrls:(t,e)=>{const n=e.data;return[...t.catUrls,n]}}),fn=hn(((t,e)=>{const n={catUrls:[],gamesize:6},i=Object.entries(n).map((([t,e])=>[t,()=>e]));return[ve(Object.fromEntries(i))]}));const pn=ve({gamesize:(t,e)=>e.gamesize});const vn=He({id:"memory-cat",initial:"welcome",context:{catUrls:[],gamesize:6},states:{welcome:{on:{CONFIG:{actions:"applyConfig"},START:[{target:"fetchCats",cond:"validConfig"},{target:"error"}]}},fetchCats:{always:{target:"cardTable",cond:"enoughCats"},invoke:{id:"fetchCats",src:()=>fetch("https://wow-cool.online/cats/").then((t=>t.text())).catch((t=>(console.log(t),"fallback"))),onDone:{target:"fetchCats",actions:"storeCatUrl"},onError:{target:"error"}}},cardTable:{invoke:{src:un,id:"cardTableMachine",data:{userPicks:[],cards:(t,e)=>function(t){const e=t=>({imageUrl:t,dealt:!1,revealed:!1});return t.reduce(((t,n)=>[...t,e(n),e(n)]),[])}(t.catUrls)}},on:{gameOver:{target:"gameOver"}}},gameOver:{on:{newGame:{target:"welcome",actions:"resetContext"}}},error:{after:{2e3:{target:"welcome",actions:"resetContext"}}}}},{actions:{applyConfig:pn,storeCatUrl:dn,resetContext:fn},guards:{enoughCats:function(t){return t.catUrls.length>=t.gamesize},validConfig:function(t){return t.gamesize>2&&t.gamesize<=12}}}),yn=nn(vn).onTransition(((t,e)=>{"cardTable"==t.value&&null!=t.children.cardTableMachine&&t.children.cardTableMachine.send(e)})),gn=new URL(new URL("fbd6a574.jpg",import.meta.url).href,import.meta.url).href;let mn=class extends K{render(){return O` <main> <img src="${gn}" alt="Memory Cats Title" class="title-img"> <form @submit="${this._startGame}" @change="${this._applyConfig}" id="options-form"> <label for="gamesize">Game Size:</label> <select name="gamesize" id="gamesize" form="options-form"> <option value="3">Small</option> <option value="6" selected="selected">Medium</option> <option value="8">Large</option> <option value="12">Super</option> </select> <br> <br> <input type="submit" value="Start Game"> </form> </main> `}_applyConfig(){const t=this.shadowRoot.getElementById("options-form").elements;En({type:"CONFIG",gamesize:parseInt(t.gamesize.value,10)})}_startGame(t){t.preventDefault(),En({type:"START"})}};mn.styles=o`input[type=submit]{margin:20px;padding:20px;font-size:4rem}.title-img{margin:10px}`,mn=t([Q("mc-welcome")],mn);let wn=class extends K{constructor(){super(...arguments),this.numFetched=0,this.catsRequired=0}render(){return O` <main> <p>Fetched ${this.numFetched} / ${this.catsRequired}</p> </main> `}};wn.styles=o``,t([et({type:String})],wn.prototype,"numFetched",void 0),t([et({type:String})],wn.prototype,"catsRequired",void 0),wn=t([Q("mc-fetch")],wn);let bn=class extends K{constructor(){super(),this.numFetched=0,this.catsRequired=0,window.setTimeout((()=>{const t=new CustomEvent("memory-cat-event",{bubbles:!0,composed:!0,detail:{type:"DEALCOMPLETE"}});this.dispatchEvent(t)}),2e3)}render(){return O` <main> <p>Dealing...</p> </main> `}};bn.styles=o``,t([et({type:String})],bn.prototype,"numFetched",void 0),t([et({type:String})],bn.prototype,"catsRequired",void 0),bn=t([Q("mc-dealing")],bn);let xn=class extends K{constructor(){super(),this.gamesize=0,this.cards=[],this.dancing=[];const t=t=>{const e=t.detail,{cards:n}=e;this.cards=n},e=(t,e)=>()=>window.setTimeout((()=>En({type:`${t}AnimComplete`})),e);window.addEventListener("cardDealt",(n=>{t(n),e("deal",200)()}),!1),window.addEventListener("cardRevealed",(n=>{t(n),e("reveal",500)()}),!1),window.addEventListener("cardsHidden",(n=>{window.setTimeout((()=>{t(n),e("hide",500)()}),700)}),!1),window.addEventListener("correctPick",(t=>{const n=t.detail;this.dancing=n.picks,window.setTimeout((()=>{this.dancing=[],e("correct",100)()}),1e3)}),!1),window.addEventListener("victory",(t=>{this.dancing=this.cards.map(((t,e)=>e)),window.setTimeout((()=>{this.dancing=[],e("victory",100)()}),2e3)}),!1),En({type:"tableComponentReady"})}render(){return O` <main>${this.renderCards()}</main> `}numColumns(){const t=this.cards.length,e=[3,4,6].filter((e=>e<=t/2));return e.reduce(((e,n)=>t%n==0?n:e),1)}numRows(){const t=this.cards.length;return Math.floor(t/this.numColumns())}renderCards(){if(null==this.cards||0==this.cards.length)return O``;const t=(t,e)=>["card-inner",t.revealed?"front":"back",-1==this.dancing.findIndex((t=>t==e))?"":"dance"].filter((t=>t.length>0)).join(" "),e=()=>100/Math.max(1,this.numColumns()+1);return O` <div class="card-table" style="grid-template-columns:repeat(${this.numColumns()},1fr);grid-template-rows:repeat(${this.numRows()},1fr)"> ${this.cards.map(((n,i)=>O` <div class="${((t,e)=>["card",t.dealt?"dealt":" undealt"].filter((t=>t.length>0)).join(" "))(n)}" style="width:${e()}vw"> <div @click="${()=>(t=>En({type:"cardPicked",card:t}))(i)}" class="${t(n,i)}"> <div class="card-front"> <img class="card-img" src="${n.imageUrl}" loading="eager"> </div> <div class="card-back"></div> </div> </div> `))} </div> `}};xn.styles=o`:host{--card-undealt-transform:translate(0px, 100px) rotate(20deg);--card-pos-transform:translate(0px, 0px);--card-front-transform:rotateY(180deg);--card-back-transform:rotate(0deg)}main{min-height:98vh;min-width:98vw;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;font-size:calc(10px + 2vmin);margin:0 auto;text-align:center}.card-table{display:grid;grid-gap:1rem;padding:3vw;width:94vw}.card{aspect-ratio:1/1.375;display:flex}@keyframes dealing{0%{transform:var(--card-undealt-transform)}100%{transform:var(--card-pos-transform)}}.card.dealt{animation:dealing 80ms ease-out}.card.undealt{visibility:hidden}.card-inner{border:5px ridge #8275be;border-radius:27px;height:100%;width:100%;transition:transform .8s;transform-style:preserve-3d}.card-inner.front{transform:var(--card-front-transform);background:#fff}.card-inner.back{background:#8275be}.card-back,.card-front{position:absolute;width:100%;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-front{transform:rotateY(180deg)}.card-back{transform:rotateY(0)}@keyframes dancing{0%{transform:translate(0,0) var(--card-front-transform)}25%{transform:translate(0,4px) var(--card-front-transform)}75%{transform:translate(0,-40px) var(--card-front-transform)}100%{transform:translate(0,0) var(--card-front-transform)}}.card-inner.dance{animation:dancing .3s ease-in 0s 3}.card-img{width:100%;height:100%;object-fit:contain;margin:0;position:absolute;top:50%;left:50%;margin-right:-50%;transform:translate(-50%,-50%)}`,t([et({type:Number})],xn.prototype,"gamesize",void 0),t([et({type:Array})],xn.prototype,"cards",void 0),t([et({type:Array})],xn.prototype,"dancing",void 0),xn=t([Q("mc-card-table")],xn);let _n=class extends K{constructor(){super(...arguments),this.catUrls=[]}render(){return O` <main> <p>You remembered all the cats!</p> <div class="cat-container">${this.renderCats()}</div> <button class="new-game" @click="${()=>En({type:"newGame"})}"> New Game </button> </main> `}renderCats(){return null==this.catUrls?O``:this.catUrls.map((t=>O`<img class="cat-img" src="${t}" loading="eager">`))}};function Sn(t){yn.send(t.detail)}function En(t){window.dispatchEvent(new CustomEvent("memory-cat-event",{bubbles:!0,composed:!0,detail:t}))}_n.styles=o`.cat-container{display:flex;flex-direction:column;align-items:center;width:100%}.cat-img{max-width:90vw;max-height:90vw;width:auto;height:auto;margin-bottom:10px}.new-game{font-size:8rem;margin:20px;padding:20px}`,t([et({type:Array})],_n.prototype,"catUrls",void 0),_n=t([Q("mc-game-over")],_n);class $n extends K{constructor(){super(),this.stateName="",this.context={catUrls:[],gamesize:6},yn.onTransition(((t,e)=>{const n=JSON.stringify(t.value);this.stateName=n.replace(/"/g,""),this.context=t.context;const i=new CustomEvent(e.type,{composed:!0,detail:e});window.dispatchEvent(i)})),yn.start(),window.addEventListener("memory-cat-event",Sn)}render(){return O` <main>${this.renderApp()}</main> `}renderApp(){switch(this.stateName){case"welcome":return O`<mc-welcome></mc-welcome>`;case"fetchCats":return O`<mc-fetch catsRequired="${this.context.gamesize}" numFetched="${this.context.catUrls.length}"></mc-fetch>`;case"cardTable":return O`<mc-card-table></mc-card-table>`;case"gameOver":return O`<mc-game-over catUrls="${JSON.stringify(this.context.catUrls)}"></mc-game-over>`;default:return O`Error!`}}}$n.styles=o`:host{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;font-size:calc(10px + 2vmin);color:#1a2b42;max-width:960px;margin:0 auto;text-align:center;background-color:var(--memory-cat-app-background-color)}main{flex-grow:1}.app-footer{font-size:calc(12px + .5vmin);align-items:center}.app-footer a{margin-left:5px}`,t([et({type:String})],$n.prototype,"stateName",void 0),t([et({type:Object})],$n.prototype,"context",void 0),customElements.define("memory-cat-app",$n);
